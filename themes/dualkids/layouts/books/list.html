{{ define "main" }}
  {{ if .Sections }}
    <section class="books-grid">
      <h1 class="section-title">Books</h1>
      <div class="grid">
        {{ range .Sections.ByTitle }}
          {{ $book := . }}
          <a class="book-card" href="{{ .RelPermalink }}" style="--cover: {{ or .Params.coverColor site.Params.primaryColor }};">
            <div class="book-card-inner">
              <div class="book-card-media">
                {{ with .Params.cover }}
                  <img class="book-card-cover" src="{{ . | relURL }}" alt="Cover of {{ $book.Title }}" />
                {{ else }}
                  <div class="book-card-cover placeholder" aria-hidden="true">ðŸ“˜</div>
                {{ end }}
              </div>
              <h3 class="book-title">{{ .Title }}</h3>
              {{ with .Params.author }}<p class="book-author">by {{ . }}</p>{{ end }}
              <div class="badges">
                {{ with .Params.status }}<span class="badge status status-{{ . }}">{{ . }}</span>{{ end }}
                {{ if .Params.featured }}<span class="badge badge-featured">Featured</span>{{ end }}
              </div>
              {{ with .Params.plannedChapters }}
                {{ $count := len $book.Pages }}
                <p class="progress">Chapters: {{ $count }} / {{ . }}</p>
              {{ end }}
            </div>
          </a>
        {{ end }}
      </div>
    </section>
  {{ else }}
    <article class="book">
      {{ partial "breadcrumbs.html" . }}
      <header class="book-header" style="--cover: {{ or .Params.coverColor site.Params.primaryColor }};">
        <div class="book-header-media">
          {{ with .Params.cover }}
            <img class="book-cover" src="{{ . | relURL }}" alt="Cover of {{ $.Title }}" />
          {{ else }}
            <div class="book-cover placeholder" aria-hidden="true">ðŸ“˜</div>
          {{ end }}
        </div>
        <h1 class="book-title">{{ .Title }}</h1>
        <p class="book-meta">
          {{ with .Params.author }}<span>by {{ . }}</span>{{ end }}
          {{ with .Params.status }}<span class="badge status status-{{ . }}">{{ . }}</span>{{ end }}
          {{ if .Params.featured }}<span class="badge badge-featured">Featured</span>{{ end }}
        </p>
        {{ with (or .Params.description .Params.summary) }}<p class="book-desc">{{ . }}</p>{{ end }}
        {{ with .Params.plannedChapters }}
          {{ $count := len $.Pages }}
          <p class="progress">Chapters available: {{ $count }} / {{ . }}</p>
        {{ end }}
      </header>
      <section class="chapters">
        <h2>Chapters</h2>
        <ol class="chapter-list">
          {{ range .Pages.ByWeight }}
            <li>
              <a href="{{ .RelPermalink }}">{{ .Title }}</a>
              {{ with .Params.summary }}<span class="chapter-summary">â€” {{ . }}</span>{{ end }}
            </li>
          {{ end }}
        </ol>
      </section>
    </article>
  {{ end }}
{{ end }}

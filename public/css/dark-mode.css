/* Dark Mode / Night Reading Theme */

/* Default to dark mode for better sleep */
:root {
  /* Light mode colors (when toggled on) */
  --light-bg: #fffdf8;
  --light-ink: #212121;
  --light-ink-dim: #666;
  --light-card-bg: #ffffff;
  --light-border: rgba(0, 0, 0, 0.08);
  --light-hover: rgba(0, 0, 0, 0.03);
  
  /* Dark mode colors (default) - warm tones for bedtime */
  --dark-bg: #1a1611;  /* Warm dark brown instead of pure black */
  --dark-ink: #e8d7c3;  /* Warm cream color for text */
  --dark-ink-dim: #a89577;  /* Muted warm brown */
  --dark-card-bg: #252119;  /* Slightly lighter warm brown */
  --dark-border: rgba(232, 215, 195, 0.1);
  --dark-hover: rgba(232, 215, 195, 0.05);
  --dark-accent: #ffa94d;  /* Warm orange accent */
}

/* Default to dark mode - applies to both html and body */
html:not(.light-mode),
body:not(.light-mode) {
  background: var(--dark-bg) !important;
  color: var(--dark-ink) !important;
}

body {
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* Light mode when toggled */
html.light-mode,
body.light-mode,
.light-mode body {
  background: var(--light-bg) !important;
  color: var(--light-ink) !important;
}

/* Theme toggle button */
.reading-buttons {
  display: flex;
  gap: 0.5rem;
}

.theme-toggle-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 40px;
  height: 40px;
  border-radius: 8px;
  border: 1px solid var(--dark-border);
  background: var(--dark-card-bg);
  color: var(--dark-ink);
  cursor: pointer;
  transition: all 0.3s ease;
}

body.light-mode .theme-toggle-btn {
  border: 1px solid var(--light-border);
  background: var(--light-card-bg);
  color: var(--light-ink);
}

.theme-toggle-btn:hover {
  background: var(--dark-hover);
  border-color: var(--dark-accent);
}

body.light-mode .theme-toggle-btn:hover {
  background: var(--light-hover);
  border-color: var(--primary);
}

/* Show/hide sun and moon icons - Fixed with better specificity */
.theme-toggle-btn .sun-icon {
  display: none !important;
}

.theme-toggle-btn .moon-icon {
  display: block !important;
}

.light-mode .theme-toggle-btn .sun-icon,
body.light-mode .theme-toggle-btn .sun-icon {
  display: block !important;
}

.light-mode .theme-toggle-btn .moon-icon,
body.light-mode .theme-toggle-btn .moon-icon {
  display: none !important;
}

/* Dark mode specific element styles */
.chapter-top-bar {
  background: rgba(26, 22, 17, 0.98);
  border-bottom: 1px solid var(--dark-border);
}

body.light-mode .chapter-top-bar {
  background: rgba(255, 255, 255, 0.98);
  border-bottom: 1px solid var(--light-border);
}

.back-to-book {
  color: var(--dark-ink-dim);
}

body.light-mode .back-to-book {
  color: var(--light-ink-dim);
}

.back-to-book:hover {
  background: var(--dark-hover);
  color: var(--dark-ink);
}

body.light-mode .back-to-book:hover {
  background: var(--light-hover);
  color: var(--light-ink);
}

.reading-settings-toggle {
  border: 1px solid var(--dark-border);
  background: var(--dark-card-bg);
  color: var(--dark-ink-dim);
}

body.light-mode .reading-settings-toggle {
  border: 1px solid var(--light-border);
  background: var(--light-card-bg);
  color: var(--light-ink-dim);
}

.reading-settings-toggle:hover {
  background: var(--dark-hover);
  border-color: var(--dark-accent);
}

body.light-mode .reading-settings-toggle:hover {
  background: var(--light-hover);
  border-color: var(--primary);
}

.reading-panel {
  background: var(--dark-card-bg);
  border-bottom: 1px solid var(--dark-border);
}

body.light-mode .reading-panel {
  background: var(--light-card-bg);
  border-bottom: 1px solid var(--light-border);
}

.control-btn {
  border: 1px solid var(--dark-border);
  background: var(--dark-card-bg);
  color: var(--dark-ink);
}

body.light-mode .control-btn {
  border: 1px solid var(--light-border);
  background: var(--light-card-bg);
  color: var(--light-ink);
}

.control-btn:hover {
  background: var(--dark-hover);
  border-color: var(--dark-accent);
}

body.light-mode .control-btn:hover {
  background: var(--light-hover);
  border-color: var(--primary);
}

.control-btn[aria-pressed="true"] {
  background: var(--dark-accent);
  color: var(--dark-bg);
  border-color: var(--dark-accent);
}

body.light-mode .control-btn[aria-pressed="true"] {
  background: var(--secondary);
  color: white;
  border-color: var(--secondary);
}

.chapter-header {
  border-bottom: 2px solid var(--dark-border);
}

body.light-mode .chapter-header {
  border-bottom: 2px solid var(--light-border);
}

.chapter-title {
  color: var(--dark-ink);
}

body.light-mode .chapter-title {
  color: var(--light-ink);
}

.chapter-summary {
  color: var(--dark-ink-dim);
}

body.light-mode .chapter-summary {
  color: var(--light-ink-dim);
}

/* Content blocks */
.readable .bp {
  background: var(--dark-card-bg);
  border-left: 3px solid var(--dark-accent);
  box-shadow: 0 2px 8px rgba(0,0,0,0.3);
}

body.light-mode .readable .bp {
  background: rgba(255,255,255,0.6);
  border-left: 3px solid var(--secondary);
  box-shadow: 0 2px 8px rgba(0,0,0,0.05);
}

.readable .bp:hover {
  background: rgba(37, 33, 25, 0.8);
  box-shadow: 0 4px 12px rgba(0,0,0,0.4);
}

body.light-mode .readable .bp:hover {
  background: rgba(255,255,255,0.8);
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

/* Language labels */
.lang-label {
  color: var(--dark-accent);
}

body.light-mode .lang-label {
  color: var(--secondary);
}

.lang-es {
  color: var(--dark-ink-dim);
}

body.light-mode .lang-es {
  color: rgba(33, 33, 33, 0.85);
}

/* Navigation cards */
.nav-card {
  border: 1px solid var(--dark-border);
  background: var(--dark-card-bg);
  color: var(--dark-ink);
}

body.light-mode .nav-card {
  border: 1px solid var(--light-border);
  background: var(--light-card-bg);
  color: var(--light-ink);
}

.nav-card:hover {
  background: var(--dark-hover);
  border-color: var(--dark-accent);
  box-shadow: 0 4px 12px rgba(0,0,0,0.3);
}

body.light-mode .nav-card:hover {
  background: var(--light-hover);
  border-color: var(--light-border);
  box-shadow: 0 4px 12px rgba(0,0,0,0.08);
}

.nav-label {
  color: var(--dark-ink-dim);
}

body.light-mode .nav-label {
  color: var(--light-ink-dim);
}

.nav-title {
  color: var(--dark-ink);
}

body.light-mode .nav-title {
  color: var(--light-ink);
}

.chapter-dropdown {
  border: 1px solid var(--dark-border);
  background: var(--dark-card-bg);
  color: var(--dark-ink);
}

body.light-mode .chapter-dropdown {
  border: 1px solid var(--light-border);
  background: var(--light-card-bg);
  color: var(--light-ink);
}

.chapter-dropdown:hover {
  border-color: var(--dark-accent);
}

body.light-mode .chapter-dropdown:hover {
  border-color: var(--primary);
}

.chapter-dropdown:focus {
  border-color: var(--dark-accent);
  box-shadow: 0 0 0 3px rgba(255, 169, 77, 0.1);
}

body.light-mode .chapter-dropdown:focus {
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(0, 122, 204, 0.1);
}

/* Chapter navigation borders */
.chapter-navigation {
  border-top: 2px solid var(--dark-border);
}

body.light-mode .chapter-navigation {
  border-top: 2px solid var(--light-border);
}

/* Size indicator */
.size-indicator {
  color: var(--dark-ink);
}

body.light-mode .size-indicator {
  color: var(--light-ink);
}

/* Control labels */
.control-label {
  color: var(--dark-ink-dim);
}

body.light-mode .control-label {
  color: var(--light-ink-dim);
}

/* Pronunciation guides in dark mode */
.character-name {
  border-bottom-color: var(--dark-ink-dim);
}

body.light-mode .character-name {
  border-bottom-color: var(--light-ink-dim);
}

.pronunciation-guide {
  background: var(--dark-card-bg);
  color: var(--dark-accent);
  border: 1px solid var(--dark-border);
}

body.light-mode .pronunciation-guide {
  background: #333;
  color: white;
  border: none;
}

body.show-all-pronunciation .pronunciation-guide {
  color: var(--dark-ink-dim);
}

body.light-mode.show-all-pronunciation .pronunciation-guide {
  color: var(--light-ink-dim);
}

/* Special styling for very dark environments */
@media (prefers-color-scheme: dark) {
  /* System already prefers dark, so we're good */
}

/* Reduced motion for theme transitions */
@media (prefers-reduced-motion: reduce) {
  body {
    transition: none;
  }
  
  * {
    transition-duration: 0.01ms !important;
  }
}